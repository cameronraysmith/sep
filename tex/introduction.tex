%!TEX root = ../plos_template.tex
Probabilistic models of gene regulation serve as a bridge between theory and experiment.  On the one hand, parameters in a probabilistic model can be fit to data obtained by measuring gene expression using microarray or sequence census methods \cite{Friedman2008a,Zhang2013}.  On the other hand, one can model a genetic network as a deterministic or stochastic reaction network which tracks levels of molecules at the nucleic acid or protein level \cite{Alon2006,Voit2012}.  From the solution to this latter kind of model, one can then obtain theoretical predictions for the parameters of the probabilistic model in terms of reaction rates.  Comparison of the parameters fitted from data with the predicted values serves as a means for comparing theory with experiment and can serve as a starting point for improving the theory or for designing future experiments \cite{Tonsing2014}.

An important feature of experimental science is that it involves partial information.  In the course of a single measurement, one typically is not able to observe a biological network in its entirety.  Rather, one observes a subnetwork at a time and only obtains a more complete picture by later combining these partial views.  This contrasts with theory, where, one makes a representation of a closed system that provides explicit values for all quantities of interest.  In order for a probabilistic model to serve its purpose, it should also accomodate partial information and thus we will explicitly consider the effects of 1) carving out a subnetwork from its context and 2) coarse-graining observables. Observables representing partial information will generally arise in situations where a system is interacting with another system. This situation arises in the context of interpreting gene expression data as well as in the interactions of an organism's gene regulatory network with the organism's environment.

% Studying this situation, we find that instances arise where the fact that a network context may interact with only partial information of the states of a given subnetwork can result in apparent inconsistency. Furthermore,

Inconsistency arises when a network context places more constraints on a network than it is capable of satisfying. One of the canonical examples of this arose in the study of ferromagnetism via the Ising model on a triangular lattice where so-called \emph{frustration} arises among the couplings of three nearest-neighbor spins \cite{Wannier1950,Toulouse1977,Vannimenus1977}. We exhibit a method of checking for such consistency and evaluating its likelihood of arising in the context of building probabilistic models of gene regulatory networks. When apparent inconsistency is observed, it must arise from the network context interacting with only partial information of the states of a given subnetwork. This would indicate that information about the network context must be included in order to maintain a consistent model of the system.

Consider the case in which the network context is an environment placing independent and identical functional requirements upon a population of similar independent subnetworks and selecting for their architectures over many generations to satisfy those requirements. Our analysis of the probability of inconsistency arising relative to network architecture demonstrates that networks with a larger number of cycles are more likely to be subjected to inconsistent constraints that will be unable to be jointly satisfied. Since this probability of inconsistency is higher for networks with a larger number of cycles, this results in implicit selection against regulatory network architectures with a larger number of cycles. One would not expect such a bias to eliminate the existence of cycles in gene regulatory networks. However, it is reasonable to expect on the basis of this result a kind of hierarchical modularity: where modules that may possess cycles and are small relative to the overall size of the network exist within a globally hierarchical network structure. A similar problem has been considered previously in the context of population genetics \cite{EthanAkin389}. Of course, there are other factors which may contribute to the development of such network architectures. The evaluation of the hierarchical modularity property will require extensive future work, but its existence is consistent with many studies that have evaluated the architecture of gene-regulatory networks~\cite{Ravasz2002,Segre2005,Wagner2007,Erwin2009,Jothi2009,Bhardwaj2010,Chalancon2012,Colm}.

We explain the connection between stochastic process models of gene expression and \gnpm{} in \ref{sec:genenetworkphenmap}. \ref{sec:probabilitydistributionsonnetworks}--\ref{sec:compatibilityofgpms} contain the underlying mathematical justification for our claims, and they can be skipped by those who are primarily interested in the implications of our results. In \ref{sec:probabilitydistributionsonnetworks} we introduce the concept of network modules and define probability distributions over their expression states. We describe how one can pass from expression states to more coarse-grained phenotypes such as the ability to produce a given metabolite in a manner that is dependent upon interactions among multiple genes in \ref{sec:coarsegrainingphenotypes}. In \ref{sec:covergenotypespace} we define a gene regulatory network architecture (GRNA) as a collection of subsets of genes that together comprise a larger set of genes. The different ways in which this is accomplished correspond to distinct GRNAs. \ref{sec:compatibilityofgpms} describes the different compatibility conditions that arise for different GRNAs and demonstrates how these compatibility conditions lead to a set of inequalities determining a space of probability distributions for each GRNA. \ref{sec:cycliccontextunsatisfiableconstraints} and \ref{sec:probconstrgeometry} examine these constraints for the example of the three-cycle GRNA. \ref{sec:volrat} computes the likelihood of unsatisfiable constraints for all GRNAs on four genes that possess cycles. Finally, \ref{sec:unsatisfiableconstrevolution} explains implications for the evolution of GRNA of the result that networks with a larger number of cycles are more likely to have unsatisfiable constraints placed upon them.

% Traditional dynamical models of gene-regulatory networks begin by treating them as reaction networks whose known or hypothesized interactions are encoded by sigmoidal response functions \cite{Alon2006,Voit2012}. Genes that interact do so in such a manner as to either activate or inhibit one another leading to a dynamical model of the gene expression process.
% \begin{eqnarray*}
% {dg_i \over dt} =
% k_{is}  \prod_{j=1}^{N} \frac{k_{ija} g_j^{n_{ija}}}{1+k_{ija} g_j^{n_{ija}}}
% \frac{1}{1+k_{ijr} g_j^{n_{ijr}}} - k_{id} g_i
% \end{eqnarray*}
% for a network of $N$ genes where $g_i$s represent concentrations of gene products, $k_{ija}$s represent activation rates, $k_{ijr}$s represent repression rates, and $k_{id}$s represent degradation rates.
% The dual perspective is taken by probabilistic models whose parameters are fit to data obtained by measuring gene expression using microarray or sequence census methods \cite{Friedman2008a,Zhang2013}.
% In both of these classes of models, higher-order correlations are assumed to be accurately represented in terms of a sum over lower-order correlations.

% The evolution of \gnpm{} is an open question in biology. Specifically, how the higher level constraints imposed upon a system at a phenotypic level shape the elements and the interaction among the elements at a lower, genotypic level. Here we neglect the specific mechanisms by which one achieves such phenotypes and assume a statistical view of the observed phenotype. This communication introduces a framework that enable us to analyze how higher-level constraints, formulated in terms of probability of gene expression pattern might shape the allowable interactions among elements at a lower level.

% The genotype of an organism has a relatively straightforward definition in terms of the sequence of nucleotides comprising its genome. Phenotypes, on the other hand, can be described at different levels of organization~\cite{Dawkins1982,Stadler2001}. The concept of phenotype was initially defined at the level of macroscopically observable physical characteristics such as shape, size, color, and various combinations thereof~\cite{Johannsen1911}. However, since the advent of molecular biology, the lowest level description of phenotype might be considered to be the dynamic phenomenon that can be described by measuring the transcription states of all genes comprising an organism's genome. The time series that results from such observations can be used to infer various statistics that characterize gene expression such as correlations between pairs of genes. The statistics associated to any higher-level phenotype that is determined by a particular gene expression pattern should be functions of such statistics.

% % The present capability to observe phenotypes at various levels of organization raises several questions about \gnpm{}. One is how to define and characterize properties of the fundamental level of \gnpm{} that is embodied in the transcription process. Another is how to define and characterize the manner in which higher-order ``phenotype$_i$-phenotype$_{i+1}$'' mappings built on top of this one are affected by the properties of each of the levels existing below, and, on evolutionary timescales over which feedback may play a significant role, potentially also those above it.

% % We attempt to address these questions from an abstract perspective that is independent of the particular physical implementation of \gnpm{} in terms of complex networks of molecular interactions.
% We present a formal probabilistic description of the \gnpm{} that takes into account higher-order correlations among genes as well as evidence that gene expression is stochastic \cite{Swain2002,Paulsson2004,Thattai2004,Acar2008a,Lestas2010,So2011,Munsky2012,Neuert2013,Sanchez2013}. In order to assess the impact of these features on the evolution of gene regulatory network architecture, where architecture is here considered to be determined exclusively by observable correlations among genes \cite{Friedman2008a}, we use this description to precisely pose the question: For any genotype, given a space of probability distributions on the collection of \gnpm{}, does modularization of the genotype (restriction of correlations among genes, \refsupp{}) increase, decrease, or leave invariant the size of the accessible space of selectable gene expression patterns?
% % For example, if we have three genes that can all participate in a higher-order interaction (the highest-order among three genes being a trinary interaction) that generates a phenotype, but we restrict interactions to a lower-order subset consisting of all three possible binary interactions then this represents one particular way of modularizing over a given genotype (compare \ref{fig:conediagram}B top and middle).

% For those cases in which modularization results in no change to the space of probability distributions over \gnpm{} with respect to that defined on the full genotype (i.e. the single highest-order correlation referred to as non-modular), then there may be no method to select for one network architecture over another. On the other hand any differences in gene expression patterns that result from differences in network architecture may allow certain network architectures to be selected relative to one another. Here we show that those modularizations that introduce cycles into the gene-regulatory network architecture also expose the capacity for negative selection as a result of additional restrictions upon the gene expression patterns that apply to networks with cycles but not to those without.

% % then there would be no way to observationally distinguish the collection of possible gene expression patterns of organisms incorporating molecular mechanisms that explicitly impose such modularity, and thus no means of selecting specifically for modular or non-modular gene regulatory networks~\cite{Jothi2009,Colm}. If, on the other hand, modularization provides access to a larger or smaller space of probability distributions over \gnpm{} than for the non-modular case, then one can imagine that certain environmental conditions would be unable to be addressed by the functions capable of being achieved by the gene expression profiles accessible to one gene-regulatory network with respect to another. We provide a precise quantitative answer to the question stated above for several different modularizations over a collection of interacting genes.

% % In a network context in which all interaction orders are allowed, restriction of higher-order interactions within the underlying process intuitively reduces the size of the space of accessible gene expression patterns. However, in network contexts that are constrained to match the stationary structure of the underlying process, modularizations over a genotype that include at least one cycle in the hypergraph representing the resulting modular structure provide access to a \emph{larger} collection of potential gene expression patterns and thus a larger collection of potential biological functions that may derive from the expanded repertoire of such patterns. We provide a precise quantitative answer to the question stated above for several different modularizations over a collection of interacting genes.
